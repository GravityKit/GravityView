/**
 * SelectWoo Multiselect styles for GravityView admin.
 *
 * Uses WordPress Gutenberg FormTokenField design patterns.
 * @see https://github.com/WordPress/gutenberg/tree/trunk/packages/components/src/form-token-field
 *
 * @package   GravityView
 * @license   GPL2+
 * @since     2.35
 */

// Dropdown - appended to body, uses custom class for specificity.
// Styled to match Gravity Forms enhanced select.
.gv-multiselect-dropdown {
	&.select2-dropdown {
		z-index: 100001;
		border: 1px solid #9092b2;
		border-radius: 0 0 3px 3px;
		border-top: none;
		box-shadow: none;
		margin-top: 0;
		background: #fff;
	}

	// Dropdown options - GF style with left border indicator.
	.select2-results__option {
		padding: .75em 1.5em;
		color: #1e1e1e;
		font-size: 14px;
		line-height: 1.25;
		background: #fff;
		cursor: pointer;
		border-bottom: 1px solid #e8e8e8;
		border-left: 2px solid transparent;
		margin: 0;
		max-height: 300px;

		// Keyboard/hover highlight - light blue like GF.
		&.select2-results__option--highlighted[data-selected] {
			background-color: #f6f9fc;
			border-left-color: #242748;
			color: #1e1e1e;
		}

		// Already selected items - simple checkmark.
		&[data-selected="true"] {
			background-color: #fff;
			padding-left: 36px;
			position: relative;

			// Checkmark icon.
			&::before {
				content: "\2713";
				position: absolute;
				left: 1em;
				top: 50%;
				transform: translateY(-50%);
				color: #3e7da6;
				font-size: 16px;
				font-weight: bold;
			}

			// Selected + highlighted.
			&.select2-results__option--highlighted {
				background-color: #f6f9fc;
				border-left-color: #242748;
			}
		}

		&:last-child {
			border-bottom: none;
		}
	}

	// Search field in dropdown.
	.select2-search--dropdown {
		padding: 8px;
		border-bottom: 1px solid #e8e8e8;

		.select2-search__field {
			border: 1px solid #9092b2;
			border-radius: 3px;
			padding: 8px 12px;
			font-size: 14px;
			outline: none;
			width: 100%;
			box-sizing: border-box;

			&:focus {
				border-color: #007cba;
				box-shadow: 0 0 0 1px #007cba;
			}
		}
	}

	.select2-results {
		max-height: 200px;
		overflow-y: auto;
	}
}

// Selection box - class is added directly to .select2-selection--multiple via containerCssClass.
.select2-selection--multiple.gv-selectwoo-container {
	border: 1px solid #949494;
	border-radius: 2px;
	background-color: #fff;
	min-height: 32px;
	padding: 4px;

	// Rendered tags container.
	.select2-selection__rendered {
		padding: 0;
		margin: 0;
		display: flex;
		flex-wrap: wrap;
		align-items: center;
		gap: 4px;
		list-style: none;
	}

	// Individual tokens - Gutenberg FormTokenField style.
	.select2-selection__choice {
		background-color: #ddd;
		border: none;
		border-radius: 2px;
		color: #1e1e1e;
		font-size: 13px;
		line-height: 24px;
		padding: 0 8px 0 0; // Right padding for text
		margin: 0;
		display: inline-flex;
		align-items: center;
		max-width: 100%;
		float: none;

		// Remove button - appears before text in DOM, style for left side.
		.select2-selection__choice__remove {
			background: #ddd;
			border-radius: 2px 0 0 2px;
			color: #1e1e1e;
			font-size: 14px;
			font-weight: normal;
			line-height: 24px;
			padding: 0 6px 0 8px;
			margin: 0;
			cursor: pointer;
			border: none;
			float: none;

			&:hover {
				color: #d63638;
			}
		}
	}

	// Search input inside selection.
	.select2-search--inline {
		float: none;
		margin: 0;

		.select2-search__field {
			margin: 0;
			padding: 0 4px;
			font-size: 13px;
			line-height: 24px;
			min-height: 24px;
			border: none;
			box-shadow: none;
			background: transparent;

			&::placeholder {
				color: #757575;
			}
		}
	}

	// Clear all button - override SelectWoo's float:right and margin-top:5px.
	.select2-selection__clear {
		float: none;
		margin-top: 0;
		color: #757575;
		font-size: 16px;
		margin-right: 4px;
		padding: 0 4px;
		cursor: pointer;
		line-height: 24px;
		display: flex;
		align-items: center;
		align-self: center;

		&:hover {
			color: #d63638;
		}
	}
}

// Focus/open states - target container that has our selection inside.
.select2-container--focus .select2-selection--multiple.gv-selectwoo-container,
.select2-container--open .select2-selection--multiple.gv-selectwoo-container {
	border-color: #007cba;
	box-shadow: 0 0 0 1px #007cba;
	outline: none;
}

// RTL support for SelectWoo multiselect.
[dir="rtl"] {

	// Selection box RTL adjustments.
	.select2-selection--multiple.gv-selectwoo-container {

		// Token remove button - flip border-radius and padding.
		.select2-selection__choice .select2-selection__choice__remove {
			border-radius: 0 2px 2px 0;
			padding: 0 8px 0 6px;
			margin-left: 0;
			margin-right: 0;
		}

		// Token text padding - flip for RTL.
		.select2-selection__choice {
			padding: 0 0 0 8px;
		}

		// Clear button - flip margin.
		.select2-selection__clear {
			margin-right: 0;
			margin-left: 4px;
		}

		// Search input padding.
		.select2-search--inline .select2-search__field {
			padding: 0 4px;
		}
	}

	// Dropdown RTL adjustments.
	.gv-multiselect-dropdown {

		.select2-results__option {
			border-left: none;
			border-right: 2px solid transparent;

			// Highlighted state - border on right.
			&.select2-results__option--highlighted[data-selected] {
				border-left: none;
				border-right-color: #242748;
			}

			// Selected items - checkmark on right side.
			&[data-selected="true"] {
				padding-left: .75em;
				padding-right: 36px;

				&::before {
					left: auto;
					right: 1em;
				}

				&.select2-results__option--highlighted {
					border-left: none;
					border-right-color: #242748;
				}
			}
		}
	}
}
