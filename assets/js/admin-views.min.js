!function(c){var g,o;c.widget.bridge("gvTooltip",c.ui.tooltip);let l=c('<svg class="loading" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 12C2 6.47715 6.47715 2 12 2V5C8.13401 5 5 8.13401 5 12H2Z" fill="currentColor"></path></svg>'),n='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path d="M2.2 7.2c.4 0 .7-.3.7-.7V6l-.2-2.1 1.6 1.7 2 2c.1.2.3.2.5.2.5 0 .8-.3.8-.8 0-.2 0-.4-.2-.5l-2-2-1.7-1.6h2.2c0 .1.5.1.5.1.4 0 .7-.3.7-.7 0-.4-.3-.7-.7-.7H2.6c-.8 0-1.2.5-1.2 1.2v3.7c0 .4.3.7.8.7zm7.4 7.5h3.8c.8 0 1.2-.4 1.2-1.2V9.8c0-.4-.3-.7-.8-.7-.4 0-.7.3-.7.7v2.6c.1 0-1.5-1.7-1.5-1.7l-2-2c-.1-.1-.3-.2-.5-.2-.5 0-.8.3-.8.8s0 .4.2.5l2 2 1.7 1.6H10c0-.1-.5-.1-.5-.1-.4 0-.7.3-.7.7 0 .4.3.7.7.7z"/></svg>';g={startFreshStatus:!1,hasUnsavedChanges:!1,altKey:!1,dialogWidth:750,performingAjaxAction:!1,maxDialogWidth:.95,ignoreEscapeEvent:!1,init:function(){var a=g,o=(a.gvSelectForm=c("#gravityview_form_id"),a.gvSwitchView=c("#gv_switch_view_button"),a.currentFormId=a.gvSelectForm.val(),a.currentDirectoryTemplate=c("#gravityview_directory_template").val(),a.currentSingletemplate=c("#gravityview_single_template").val(),a.directAccessSelect=c("#gv-direct-access-select"),a.toggleInitialVisibility(a),c(document.body).on("keydown keyup",a.altKeyListener).on("change","#gravityview_form_id",a.formChange).on("click",'a[href="#gv_start_fresh"]',a.startFresh).on("click","#publish, #save-post",a.processFormSubmit).on("submit","#post",a.processFormSubmit).on("click",".gv-view-types-hover",a.selectTemplateHover).on("click","a[rel*=external]",a.openExternalLinks).on("click mouseup keyup",a.closeTooltips).on("click",'.gv-field-filter-form span[role="button"]',a.switchTooltipLayout).on("click","#gv_switch_view_button",a.switchView).on("click",".clear-all-fields",a.removeAllFields).on("click",".gv_select_template",a.selectTemplate).on("change","select[data-view-dropdown]",a.selectTemplate).on("click",".ui-tooltip-content .gv-fields",a.startAddField).on("click",".gv-add-field-before",function(){c(this).closest(".active-drop-container").find("a.gv-add-field").trigger("click",{before:c(this).closest(".gv-fields")})}).on("click",".gv-field-duplicate",a.duplicateField).on("click","#gv-direct-access .edit-direct-access",a.editDirectAccess).on("click","#gv-direct-access-select .cancel-direct-access",a.cancelDirectAccess).on("click","#gv-direct-access-select .save-direct-access",a.updateDirectAccess).on("gravityview_form_change",a.updateFormLinks).on("gravityview_form_change",a.updateWidgetFormIds).on("change",".gv-dialog-options input[name*=show_as_link]",a.toggleShowAsEntry).on("change",".gv-dialog-options input[name*=only_loggedin]",a.toggleCustomVisibility).on("change",".gv-dialog-options [name*=allow_edit_cap]",a.toggleCustomVisibility).on("change",".gv-dialog-options [name*=input_type]",a.toggleInputHidden).on("click",".gv-field-controls .gv-remove-field",a.removeField).on("click",".gv-field-controls .gv-field-settings",a.openFieldSettings).on("dblclick",".gv-fields:not(.gv-nonexistent-form-field) h5",a.openFieldSettings).on("change","#gravityview_settings",a.changedSettingsAction).on("click",'div[data-js="gform-simplebar"]',a.changedSettingsAction).on("click",".gv-field-details--toggle",function(e){var t=c(this).parents(".ui-dialog"),i=c(".gv-field-details",t).hasClass("gv-field-details--closed");return g.toggleFieldDetails(t,i),c.cookie("gv-field-details-expanded",i,{path:gvGlobals.admin_cookiepath}),!1}).on("search keydown keyup",".gv-field-filter-form input:visible",a.setupFieldFilters).on("click",".gv-section .is-dismissible .notice-dismiss",function(e){var t=c(this).parents(".gv-section").attr("id")+"-"+c("#post_ID").val();c.cookie("warning-dismissed-"+t,1,{path:gvGlobals.admin_cookiepath}),c(document.body).trigger("gravityview/tabs-ready")}).on("gravityview/loaded gravityview/tabs-ready gravityview/field-added gravityview/field-removed gravityview/all-fields-removed gravityview/show-as-entry gravityview/view-config-updated",a.toggleTabConfigurationWarnings).on("gravityview/loaded gravityview/tabs-ready gravityview/field-added gravityview/field-removed gravityview/all-fields-removed gravityview/show-as-entry gravityview/view-config-updated",a.toggleRemoveAllFields).on("search keydown keyup",".gv-field-filter-form input:visible",a.setupFieldFilters).on("gravityview/loaded",function(){c(".gv-setting-list, #gravityview_settings").on("change",a.toggleCheckboxes).trigger("change")}).on("change",".gv-dialog-options",a.toggleCheckboxes).on("focus",".gv-add-field",function(e){c(this).parent(".gv-fields").addClass("trigger--hover")}).on("blur",".gv-add-field",function(e){c(this).parent(".gv-fields").removeClass("trigger--hover")}).on("keydown",".gv-add-field",function(e){if(13!==e.keyCode&&32!==e.keyCode)return!0;c(this).parent(".gv-fields").addClass("trigger--active")}).on("keyup",".gv-add-field",function(e){if(13!==e.keyCode&&32!==e.keyCode)return!0;c(this).parent(".gv-fields").removeClass("trigger--active")}).on("gravityview/dropdown/activate gravityview/dropdown/install",a.enableLockedTemplate).on("gravityview/dialog-opened",function(e,t){var i,t=c(t).parent();t.find(".gv-dialog-warning").length||0===t.find(".gv-dialog-expand").length&&a.dialogWidth<c(window).width()*a.maxDialogWidth&&(i=c("<button>",{class:"gv-dialog-expand ui-button","aria-label":gvGlobals.label_expand_dialog,"aria-expanded":"false","aria-controls":t.find(".ui-dialog-content").attr("id")||"dialog-content",title:gvGlobals.label_expand_dialog,html:'<span class="screen-reader-text">'+gvGlobals.label_expand_dialog+"</span>"+n}),t.find(".ui-dialog-titlebar").append(i))}).on("click",".gv-dialog-expand",function(e){var t,i;"keydown"===e.type&&"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e=c(this).closest(".ui-dialog"),t=c(this),i=e.hasClass("gv-dialog-expanded"),e.toggleClass("gv-dialog-expanded"),t.attr({"aria-expanded":!i,"aria-label":i?gvGlobals.label_contract_dialog:gvGlobals.label_expand_dialog,title:i?gvGlobals.label_contract_dialog:gvGlobals.label_expand_dialog}).find(".screen-reader-text").text(i?gvGlobals.label_contract_dialog:gvGlobals.label_expand_dialog).end().find("svg").replaceWith(i?n:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path d="M6.9 2c-.4 0-.7.3-.7.7v.5l.2 2.1-1.6-1.7-2-2c-.1-.2-.3-.2-.5-.2-.5 0-.8.3-.8.8s0 .4.2.5l2 2 1.7 1.6H3.2c0-.1-.5-.1-.5-.1-.4 0-.7.3-.7.7s.3.7.7.7h3.8c.8 0 1.2-.5 1.2-1.2V2.7c0-.4-.3-.7-.8-.7zm6.5 6.4H9.6c-.8 0-1.2.5-1.2 1.2v3.7c0 .4.3.7.8.7s.7-.3.7-.7v-2.6c-.1 0 1.5 1.7 1.5 1.7l2 2c.1.2.3.2.5.2.5 0 .8-.3.8-.8s0-.4-.2-.5l-2-2-1.7-1.6H13c0 .1.5.1.5.1.4 0 .7-.3.7-.7s-.3-.7-.7-.7z"/></svg>'),c(window).trigger("resize"))}).on("tooltipopen",a.onTooltipOpen),c(window).on("resize",function(){var e=c(".ui-dialog:visible").find(".ui-dialog-content");e.dialog("option","position",{my:"center",at:"center",collision:"fit",of:window,within:c("#wpwrap")}),e.dialog("option","width",a.getDialogWidth(e))}),window.addEventListener("beforeunload",e=>{a.hasUnsavedChanges&&e.preventDefault()}),gvGlobals.passed_form_id&&a.gvSelectForm.trigger("change"),window.send_to_editor);window.send_to_editor=function(e){var t=c("#"+window.wpActiveEditor);if(!t.hasClass("codemirror")&&o)return o(e);var t=t.next(".CodeMirror")[0].CodeMirror,i=t.getCursor();t.replaceRange(e,window.wp.CodeMirror.Pos(i.line,i.ch))},c("div .gform-dropdown__trigger").on("click.gravityforms",a.sendMergeTagValueToCodemirrorEditor)},getDialogWidth:function(e){var t=g.dialogWidth,e=(0<e.parents('[data-fieldid="search_bar"]').length&&(t=1200),c(window).width()*g.maxDialogWidth);return e<t?e:t},getCookieVal:function(e){return!(!e||"undefined"===e||"false"===e)&&e},toggleTabConfigurationWarnings:function(e){var t={single:{configured:c(".gv-dialog-options input[name*=show_as_link]:checked","#directory-active-fields").length||c('[data-fieldid="entry_link"]',"#directory-active-fields").length,icon:"dashicons-media-default"},edit:{configured:c('.gv-fields .field-key[value="edit_link"]').length,icon:"dashicons-welcome-write-blog"}};c.each(t,function(e,t){var i=e+"-fields-"+c("#post_ID").val(),i=g.getCookieVal(c.cookie("warning-dismissed-"+i)),a=c("#"+e+"-fields"),o=a.find(".active-drop .gv-fields").length,i=!i&&0===t.configured&&0<o;a.find(".notice-no-link").toggle(i),c('li[aria-controls="'+e+'-view"]').toggleClass("tab-not-configured",i).find(".tab-icon").toggleClass("dashicons-warning",i).toggleClass(t.icon,!i)})},altKeyListener:function(e){g.altKey=e.altKey},changedSettingsAction:function(e){o.metaboxObj.find("[name^=template_settings]:visible").each(function(){g.validateField(c(this))}),g.zebraStripeSettings()},validateField:function(e){var t=e.data("rules");t&&(t=g.validateValue(e.val(),t),e.toggleClass("gv-error",!!t),e.parent().find(".gv-error-message").remove(),t)&&e.parent().append(c("<div>",{class:"gv-error-message",text:t}))},validateValue(e,t){if(t){var i,a=g.getValidators();for(i in t)if(t.hasOwnProperty(i)){var o,n=t[i],r=n.rule,n=n.message,l="",s=!0;if(r.includes(":")&&(r=(o=r.split(/:(.+)/))[0],l=o[1]),!(s=a[r]?a[r](e,l):s))return n}}},getValidators:function(){return{required:function(e){return null!=e&&""!==e.toString().trim()},max:function(e,t){return null!=e&&Number(e)<=t},min:function(e,t){return null!=e&&Number(e)>=t},email:function(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)},integer:function(e){return Number.isInteger?Number.isInteger(Number(e)):Number(e)%1==0},matches:function(e,t){return new RegExp(t).test(e)}}},zebraStripeSettings:function(){setTimeout(function(){o.metaboxObj.find("table").each(function(){var e=c(this).find("tr").filter(":visible");e.removeClass("alternate"),e.filter(":even").addClass("alternate")})},50)},toggleCheckboxes:function(e){e=e.currentTarget||e,g.toggleRequired(e,"requires",!1),g.toggleRequired(e,"requires-not",!0),e=c(e).is(".gv-fields")?c(e):c(e).parents(".gv-fields");e.length&&(g.toggleDisabled(c("input[type=checkbox][name*=link_to_]",e),c("input[type=checkbox][name*=show_as_link]",e)),g.toggleDisabled(c("input[type=checkbox][name*=link_phone]",e),c("input[type=checkbox][name*=show_as_link]",e)))},toggleDisabled:function(e,t){0!==e.length&&0!==t.length&&(e.is(":checked")?t.prop("disabled",!0):t.is(":checked")&&e.prop("disabled",!0))},toggleRequired:function(e,o,n){let r=c(e,"#post");r.find("[data-"+o+"]").each(function(){var e=c(this),t=e.data(o).split("="),i=t[0],t=t[1],a=e.closest(".gv-dialog-options"),a=(r=0<a.length?a:r).find('[name$="['+i+']"]').filter(":input");a.is("[type=checkbox]")?n?e.toggle(0<a.filter(":not(:checked)").filter(":not(:hidden)").length):e.toggle(a.is(":checked")):a.is("[type=radio]")?n?e.toggle(!a.filter('[value="'+t+'"]').is(":checked")):e.toggle(a.filter('[value="'+t+'"]').is(":checked")):void 0!==t&&(n?e.toggle(a.val()!==t):e.toggle(a.val()===t))})},switchTooltipLayout:function(e){var t=c(this).data("value");g.setTooltipLayout(t)},setTooltipLayout:function(e){c(".gv-items-picker--"+e).addClass("active"),c(".gv-items-picker").not(".gv-items-picker--"+e).removeClass("active"),c(".gv-items-picker-container").attr("data-layout",e),c.cookie("gv-items-picker-layout",e,{path:gvGlobals.admin_cookiepath})},closeTooltips:function(e){var t=c("[data-tooltip='active']"),i=!1,a=!1;switch(e.type){case"keyup":if(27===e.keyCode){if(c(".ui-autocomplete").is(":visible"))return;if(g.ignoreEscapeEvent)return void(g.ignoreEscapeEvent=!1);a=i=0===c(".gv-field-filter-form input[data-has-search]:focus").length,window.Beacon&&window.Beacon("close")}((13===e.keyCode||32===e.keyCode)&&c(e.target).is(".close")||c(e.target).is(".dashicons-dismiss"))&&(i=!0);break;case"mouseup":c(e.target).closest(".ui-tooltip").length?i=!1:c(e.target).closest(".ui-dialog").length?0<t.length&&(i="tooltips"):0<t.length&&(i=!0),c(e.target).parents(".close").length&&(i=!0);break;case"click":c(e.target).is(".gv-overlay")&&(a=i=!0,c(e.target).remove())}if(i&&(t.gvTooltip("close"),"tooltips"!==i&&c(".ui-dialog:visible").find(".ui-dialog-content").dialog("close"),a))return!1},toggleShowAsEntry:function(e){var t=c(e.target).parents(".gv-fields");t.toggleClass("has-single-entry-link",c(e.target).is(":checked")),t.find(".gv-field-controls .dashicons-media-default").toggleClass("hide-if-js",c(e.target).not(":checked")),c(document.body).trigger("gravityview/show-as-entry",c(e.target).is(":checked"))},toggleCustomVisibility:function(e){var t=c(e.target).is("select")?"read"!==c(e.target).val():c(e.target).is(":checked"),i=c(e.target).closest(".gv-dialog-options");let a;(a=i.data("field")?i.data("field"):((i=c(e.target).closest(".gv-fields")).toggleClass("has-custom-visibility",t),i.find(".gv-field-controls")))&&a.find(".icon-custom-visibility").toggleClass("hide-if-js",!t)},toggleInputHidden:function(e){var t="hidden"===c(e.target).val(),i=c(e.target).closest(".gv-dialog-options");let a;(a=i.data("field")?i.data("field"):((i=c(e.target).closest(".gv-fields")).toggleClass("has-input-hidden",t),i.find(".gv-field-controls")))&&a.find(".icon-hidden").toggleClass("hide-if-js",!t)},selectText:function(e){return e.preventDefault(),c(this).trigger("focus").trigger("select"),!1},editDirectAccess:function(e){var t=g;e.preventDefault(),t.directAccessSelect.is(":visible")||(t.directAccessSelect.slideDown("fast",function(){t.directAccessSelect.find('input[type="radio"]').first().trigger("focus")}),c(this).hide())},cancelDirectAccess:function(e){g.directAccessSelect.slideUp("fast"),c("#gv-direct-access-display strong").text(function(){return c(this).data("initial-label")}),c("#gv-direct-access .edit-direct-access").show().trigger("focus"),e.preventDefault()},updateDirectAccess:function(e){var t,i=g.directAccessSelect.find("input:radio:checked");g.directAccessSelect.slideUp("fast"),c("#gv-direct-access .edit-direct-access").show().trigger("focus"),t="embed"===i.val(),c("#gravityview_se_embed_only").prop("checked",t),c("#gv-direct-access-display strong").text(i.data("display-label")),c("#gv-direct-access").toggleClass("embed-only",t),e.preventDefault()},toggleInitialVisibility:function(e){0!==e.gvSelectForm.length&&(""===e.currentFormId?e.hideView():c("#gravityview_directory_template").length&&0<c("#gravityview_directory_template").val().length?(c("#gravityview_select_template").slideUp(150),e.showViewConfig()):(e.templateFilter("custom"),e.showViewTypeMetabox()),e.currentFormId&&!e.currentTemplateId&&e.gvSwitchView.hide(),e.togglePreviewButton(),e.zebraStripeSettings(!0))},togglePreviewButton:function(){var e=c("#preview-action").find(".button");""===g.gvSelectForm.val()?e.hide():e.show()},hideView:function(){var e=g;e.currentFormId="",e.togglePreviewButton(),c("#gravityview_view_config, #gravityview_select_template, #gravityview_sort_filter, .gv-form-links").hide(),o.metaboxObj.hide()},updateFormLinks:function(){var t=g;c(".gv-form-links a").each(function(){var e=c(this).attr("href").replace(/id=([0-9]+)/gm,"id="+t.gvSelectForm.val());c(this).attr("href",e)})},updateWidgetFormIds:function(){var e=g;c(".field-form-id").each(function(){c(this).val(e.gvSelectForm.val())})},toggleViewTypeMetabox:function(){var e=c("#gravityview_select_template"),t=g;e.is(":visible")?(t.gvSwitchView.text(function(){return c(this).attr("data-text-backup")}),t.currentDirectoryTemplate&&e.slideUp(150)):(t.currentDirectoryTemplate?t.gvSwitchView.attr("data-text-backup",function(){return c(this).text()}).text(gvGlobals.label_cancel):t.gvSwitchView.hide(),e.slideDown(150))},showViewTypeMetabox:function(){c("#gravityview_select_template").slideDown(150)},startFresh:function(e){e.preventDefault();e=g;e.startFreshStatus=!0,e.getConfiguredFields().length?e.showDialog("#gravityview_select_preset_dialog"):e.startFreshContinue()},startFreshContinue:function(){var e=g;c("#gravityview_form_id_start_fresh").val("1"),c("#gravityview_form_id").val(""),e.currentFormId="",e.currentTemplateId="",e.gvSwitchView.hide(),e.templateFilter("preset"),e.showViewTypeMetabox(),e.hideViewConfig(),e.togglePreviewButton()},formChange:function(e){e.preventDefault();e=g;e.altKey||(e.startFreshStatus=!1,e.getConfiguredFields().length?e.showDialog("#gravityview_change_form_dialog"):e.formChangeContinue(),e.togglePreviewButton())},formChangeContinue:function(){var e=g;e.gvSelectForm.val()?(e.templateFilter("custom"),Promise.all([e.getAvailableFields(),e.getSortableFields()]).then(function(){e.currentFormId||e.currentDirectoryTemplate?(e.currentDirectoryTemplate&&e.currentDirectoryTemplate&&e.gvSwitchView.show(),e.gvSwitchView.click()):(e.showViewTypeMetabox(),e.gvSwitchView.fadeOut(150))})):(e.getConfiguredFields().remove(),e.hideView(),e.gvSwitchView.fadeOut(150)),e.currentTemplateId="",e.currentFormId=e.gvSelectForm.val(),e.setUnsavedChanges(!0),c(document.body).trigger("gravityview_form_change").addClass("gv-form-changed")},showDialog:function(e,t){var i=g,a=c(e),e={text:gvGlobals.label_cancel,click:function(){a.is("#gravityview_change_form_dialog")?(i.startFreshStatus=!1,i.gvSelectForm.val(i.currentFormId)):a.is("#gravityview_switch_template_dialog")&&(i._isViewDropDown()||i.toggleViewTypeMetabox(),i.showViewConfig()),a.dialog("close")}};t=t||[e,{text:gvGlobals.label_continue,click:function(){a.is("#gravityview_change_form_dialog")||a.is("#gravityview_select_preset_dialog")?i.startFreshStatus?i.startFreshContinue():i.formChangeContinue():a.is("#gravityview_switch_template_dialog")&&(i.selectTemplateContinue(!1),i._isViewDropDown()||i.toggleViewTypeMetabox()),i._storeValue(),a.dialog("close")}}],a.dialog({dialogClass:"wp-dialog gv-dialog",appendTo:a.parent(),draggable:!1,resizable:!1,width:i.getDialogWidth(a),open:function(){return c('<div class="gv-overlay" />').prependTo("#wpwrap"),c(document.body).trigger("gravityview/dialog-opened",a),i.toggleCheckboxes(a),i.setupFieldDetails(a),i.refresh_merge_tags(a,function(){i.setupCodeMirror(a)}),($sortableEls=c('.ui-widget-content[aria-hidden="false"]').find(".active-drop-widget, .active-drop-field")).length&&$sortableEls.each((e,t)=>{c(t).hasClass("ui-sortable")&&c(t).sortable("disable")}),!0},close:function(e){e.preventDefault(),c("textarea.code",a).each(function(){0!==($CodeMirror=c(this).next(".CodeMirror")).length&&$CodeMirror[0].hasOwnProperty("CodeMirror")&&$CodeMirror[0].CodeMirror.toTextArea()}),a.find(".merge-tag-support").removeClass("merge-tag-support").addClass("gv-merge-tag-support"),c(".gv-field-settings.active","#gravityview_view_config").removeClass("active"),i.setCustomLabel(a),c("#wpwrap").find("> .gv-overlay").fadeOut("fast",function(){c(this).remove()}),($sortableEls=c('.ui-widget-content[aria-hidden="false"]').find(".active-drop-widget, .active-drop-field")).length&&$sortableEls.each((e,t)=>{c(t).hasClass("ui-sortable")&&c(t).sortable("enable")}),i._restoreValue(),c(document.body).trigger("gravityview/dialog-closed",a)},closeOnEscape:!0,buttons:t})},setupCodeMirror:function(e){var d=g;c("textarea.code:visible",e).each(function(){var t,i,a,o,n,r,e=c.extend(!0,{},wp.codeEditor.defaultSettings),l=c(this).data("codemirror");l&&(e.codemirror=c.extend({},e.codemirror,l));let s=wp.codeEditor.initialize(c(this),e);(c(this).hasClass("merge-tag-support")||c(this).hasClass("gv-merge-tag-support"))&&(s.codemirror.setSize("95%"),t=c(this),i=t.attr("id"),l=window.gfMergeTags.getAutoCompleteMergeTags(t),a="",o=s.codemirror.getCursor(),t.parent().find(".all-merge-tags").detach().insertBefore(t),t.parent().find("div .gform-dropdown__trigger").on("click.gravityforms",d.sendMergeTagValueToCodemirrorEditor),t.autocomplete({appendTo:t.parent(),minLength:1,position:{my:"center top",at:"center bottom",collision:"none"},source:l,select:function(e,t){var t=t.item.value.replace(/^{|}$/gm,""),i=s.codemirror.getCursor();s.codemirror.replaceRange(t,o,window.wp.CodeMirror.Pos(i.line,i.ch)),s.codemirror.focus(),s.codemirror.setCursor(window.wp.CodeMirror.Pos(i.line,i.ch+t.length+1))}}),n=t.parent().find("ul.ui-autocomplete"),r=function(){c("#"+i).autocomplete("close")},c(document.body).on("keyup",function(e){n.is(":visible")&&27===e.which&&(e.preventDefault(),r(),t.trigger("focus"))}),s.codemirror.on("mousedown",function(){r()}),s.codemirror.on("keydown",function(e,t){!n.is(":visible")||38!==t.which&&40!==t.which&&13!==t.which||(n.not(":focus")&&n.trigger("focus"),t.preventDefault())}),s.codemirror.on("change",function(e,t){"{}"===t.text[0]&&(o=s.codemirror.getCursor());t=s.codemirror.getCursor();"{"===(a=s.codemirror.getRange({ch:o.ch-1,line:o.line},t))[0]?c("#"+i).autocomplete("search",a):r()}))})},sendMergeTagValueToCodemirrorEditor:function(e){var t=window.wpActiveEditor;window.wpActiveEditor=c(e.currentTarget).parentsUntil(".gv-setting-container").find("textarea").attr("id"),window.wpActiveEditor&&window.send_to_editor(c(this).data("value")),window.wpActiveEditor=t},setupFieldDetails:function(e){var t;e.parents('[data-fieldid="search_bar"]').length||(c(".gv-field-details--container",e).insertAfter(".ui-dialog-title:visible"),t=c.cookie("gv-field-details-expanded"),t=g.getCookieVal(t),g.toggleFieldDetails(e,t),g.migrateSurveyScore(e))},migrateSurveyScore:function(e){var t;0!==e.parents('[data-inputtype="survey"]').length&&(t=e.find(".gv-setting-container-score input"))&&0!=+t.val()&&e.find('.gv-setting-container-choice_display input[value="score"]').trigger("click").trigger("focus")},toggleFieldDetails:function(e,t){($parent=e.parent()).find(".gv-field-details").toggleClass("gv-field-details--closed",!t).end().find(".gv-field-details--toggle .dashicons").toggleClass("dashicons-arrow-down",!!t).toggleClass("dashicons-arrow-right",!t).end()},setCustomLabel:function(e){var t=c("[name*=admin_label]",e),t=t.length&&t.val()?t:c("[name*=custom_label]",e);c(e).closest("[data-search-fields]").length===t.closest("[data-search-fields]").length&&(e=e.closest(".gv-fields").find(".gv-field-label-text-container").first(),t.length)&&(0<(t=t.val().trim()).length?e.html(t):e.html(e.parent(".gv-field-label").data("original-title")))},ignoreEscape:function(){g.ignoreEscapeEvent=!0},getSortableFields:function(o,n){return new Promise((t,e)=>{var i=g,a=(c(".gravityview_sort_field").prop("disabled","disabled").empty().append("<option>"+gvGlobals.loading_text+"</option>"),{action:"gv_sortable_fields_form",nonce:gvGlobals.nonce});void 0!==o&&"preset"===o?a.template_id=n:a.form_id=i.gvSelectForm.val(),c.post(ajaxurl,a,function(e){"false"!==e&&"0"!==e&&c(".gravityview_sort_field").empty().append(e).prop("disabled",null),t()})})},hideViewConfig:function(){c("#gravityview_view_config").slideUp(150),c(document).trigger("gv_admin_views_hideViewConfig")},showViewConfig:function(){c("#gravityview_view_config").slideDown(150),o.metaboxObj.show(),g.toggleDropMessage(),g.init_tooltips(),c(document).trigger("gv_admin_views_showViewConfig")},switchView:function(e){e.preventDefault(),e.stopImmediatePropagation();e=g;e.templateFilter("custom"),e.toggleViewTypeMetabox()},templateFilter:function(e){c(".gv-view-types-module").each(function(){c(this).attr("data-filter")===e?c(this).parent().show():c(this).parent().hide()})},_isViewDropDown:function(){return g.wantedTemplate&&void 0!==g.wantedTemplate.data("view-data")},_getCurrentTemplateId(){var e=this._getTemplateSection();return null===e||"directory"===e?this.currentDirectoryTemplate:"single"===e?this.currentSingletemplate:""},_setCurrentTemplateId(e){var t=this._getTemplateSection();null!==t&&"directory"!==t||(this.currentDirectoryTemplate=e),null!==t&&"single"!==t||(this.currentSingletemplate=e)},_getTemplateId:function(e=!1){var t=g.wantedTemplate;if(!t)return"";let i=t.data(e?"base-template":"templateid");return g._isViewDropDown()&&(i=g.wantedTemplate.val(),i=String(t.val())),i},_getTemplateSection:function(){let e=null;return e=g._isViewDropDown()?g.wantedTemplate.data("section"):e},_restoreValue:function(){g._isViewDropDown()&&g.wantedTemplate.data("view-data").restoreValue()},_storeValue:function(){g.wantedTemplate&&(g._isViewDropDown()?g.wantedTemplate.data("view-data").storeValue():c("select[data-view-dropdown]").each(function(){c(this).data("view-data").storeValue()}),this._setCurrentTemplateId(this._getTemplateId()))},selectTemplate:function(e,t){var i,a,o=g;void 0!==t&&null===t.section||(e.preventDefault(),e.stopImmediatePropagation(),o.wantedTemplate=c(this),t=o._getTemplateId(),e=/(.*?)_(.*?)$/i,a=(i=o._getCurrentTemplateId()).replace(e,"$2"),e=t.replace(e,"$2")===a,i&&!e&&o.getConfiguredFields().length?i!==t?o.getConfiguredFields().length?o.showDialog("#gravityview_switch_template_dialog"):(o.toggleViewTypeMetabox(),o.selectTemplateContinue(e)):(o.toggleViewTypeMetabox(),o.showViewConfig()):(c("#gravityview_select_template").slideUp(150),o.selectTemplateContinue(e),o._storeValue()))},selectTemplateContinue:function(e){var t=g,i=t._getTemplateId(),a=t.gvSelectForm.val(),o=!t._getTemplateSection(),n=(o&&(n=t._getTemplateId(),c("#gravityview_directory_template").val(n).trigger("change",{section:null}),c("#gravityview_single_template").val(n).trigger("change",{section:null})),t.wantedTemplate.parents(".gv-view-types-module"));n.parents(".gv-grid").find(".gv-view-types-module").removeClass("gv-selected"),n.addClass("gv-selected"),t.waiting("start"),t.startFreshStatus?Promise.all([t.getAvailableFields("preset",i),t.getPresetFields(i),t.getSortableFields("preset",i)]).then(function(){c(".ui-tabs-panel").each(function(){t.init_droppables(this)})}):(!e||o?t.updateActiveAreas(i,+a):t.waiting("stop"),o&&(t.gvSwitchView.fadeIn(150),t.toggleViewTypeMetabox())),t.currentTemplateId=i,t.setUnsavedChanges(!0)},server_request:(e,t)=>{let i=c.Deferred();g.performingAjaxAction=!0,c(".gv-view-template-notice").hide();var{_wpNonce:a,_wpAjaxAction:o,_wpAjaxUrl:n,ajaxRouter:r,frontendFoundationVersion:l}=window.gvGlobals.foundation_licenses_router;return c.post(n,{nonce:a,action:o,ajaxRouter:r,ajaxRoute:e,frontendFoundationVersion:l,payload:t}).fail(e=>i.reject(e.responseText)).done(e=>{e.success?(g.performingAjaxAction=!1,i.resolve(e)):i.reject(e.data)}),i.promise()},selectTemplateHover:function(e){let t=g,i=c(e.target),a=i.parents(".gv-view-types-module"),o=c(this).find(".gv_select_template");if(i.is("[rel=internal]")&&!i.hasClass("gv-layout-activate")&&!i.hasClass("gv-layout-install"))return!0;e.preventDefault(),e.stopImmediatePropagation();var e=e=>{c(".gv-view-template-notice").show().find("p").html(e),document.querySelector(".gv-view-template-notice").scrollIntoView({behavior:"smooth"})},n=()=>{t.performingAjaxAction=!1,i.removeClass("disabled"),a.removeClass("active")},r=()=>{a.find(".gv-view-types-hover > div:eq(0)").hide(),a.find(".gv-view-types-hover > div:eq(1)").removeClass("hidden"),a.removeClass("gv-view-template-placeholder"),a.find("a.gv_select_template").attr("data-templateid",i.data("templateid")).trigger("click"),t.activateViewSelection(i.data("templateid")),o.trigger("click")};if(i.hasClass("gv-layout-activate"))return t.performingAjaxAction?void 0:(a.addClass("active"),i.addClass("disabled").attr("disabled",!0),i.html(l),void c.when(t.server_request("activate_product",{text_domain:i.attr("data-template-text-domain")})).then(r).always(n).fail(e));i.hasClass("gv-layout-install")&&!t.performingAjaxAction&&(a.addClass("active"),i.addClass("disabled").attr("disabled",!0),i.html(l),c.when(t.server_request("install_product",{id:i.attr("data-download-id"),text_domain:i.attr("data-template-text-domain"),activate:!0})).then(r).always(n).fail(e))},enableLockedTemplate:function(i,a){let o=c(a?.option)||null;var n=a?.action||null,r={text_domain:o.data("template-text-domain"),activate:!0};if("{}"!==JSON.stringify(r)){let t=c(i.target),e=t.closest(".view-dropdown-list-item");t.addClass("is-idle").html(l),e.addClass("is-idle"),c.when(g.server_request(n+"_product",r)).then(()=>{t.removeClass("has-failed"),g.activateViewSelection(o.data("template-id")),a?.dropdown?.focusActive()}).fail(e=>{t.addClass("has-failed").text("Error"),console.log(e)}).always(()=>{t.removeClass("is-idle"),e.removeClass("is-idle")})}},activateViewSelection:function(e){var t=c("[data-view-dropdown]"),i=t.find('option[data-template-id="'+e+'"]');i.attr("disabled",!1),i.val(e),t.each((e,t)=>{c(t).viewDropdown().renderOptions()}),g.updateSettingsArea()},openExternalLinks:function(){return window.Beacon&&(c(this).is("[data-beacon-article]")||c(this).is("[data-beacon-article-modal]")||c(this).is("[data-beacon-article-sidebar]")||c(this).is("[data-beacon-article-inline]"))||window.open(this.href),!1},previewTemplate:function(e){e.preventDefault(),e.stopImmediatePropagation();var t=c(e.currentTarget).parents(".gv-view-types-module");t.find(".gv-template-preview").dialog({dialogClass:"wp-dialog gv-dialog",appendTo:c("#gravityview_select_template"),width:g.dialogWidth,open:function(){c('<div class="gv-overlay" />').prependTo("#wpwrap")},close:function(){c(this).dialog("option","appendTo",t),c("#wpwrap").find("> .gv-overlay").fadeOut("fast",function(){c(this).remove()})},closeOnEscape:!0,buttons:[{text:gvGlobals.label_close,click:function(){c(this).dialog("close")}}]})},updateActiveAreas:function(e,t){var i=g,e={action:"gv_get_active_areas",template_id:e,form_id:t,nonce:gvGlobals.nonce};return i.updateViewConfig(e)},updateSettingsArea:function(){let t=c("#gravityview_settings .inside");t.html(""),c.get(document.URL,function(e){e&&(e=c(e),t.html(e.find("#gravityview_settings .inside").html()),o.refresh(),c("#gravityview_directory_template").trigger("change"))})},getPresetFields:function(e){var t=g,e=(c("#directory-active-fields, #single-active-fields").children().remove(),{action:"gv_get_preset_fields",template_id:e,nonce:gvGlobals.nonce});return t.updateViewConfig(e)},updateViewConfig:function(r){return new Promise((t,e)=>{let i=g,a=i._getTemplateSection(),o="directory"===a||null===a,n="single"===a||null===a;o&&c("#directory-active-fields").children().remove(),n&&c("#single-active-fields").children().remove(),c.post(ajaxurl,r,function(e){e&&(e=JSON.parse(e),o&&(c("#directory-header-widgets").html(e.header),c("#directory-footer-widgets").html(e.footer),c("#directory-active-fields").append(e.directory),c("#directory-header-widgets a[data-templateid], #directory-footer-widgets a[data-templateid]").attr("data-templateid",r.template_id).attr("data-formid",r.form_id)),n&&c("#single-active-fields").append(e.single),i.showViewConfig(),i.waiting("stop"),c(document.body).trigger("gravityview/view-config-updated",e,a)),t()}),i.setUnsavedChanges(!0)})},waiting:function(e){$containers=c("#wpwrap,.gv-fields"),"start"===e?$containers.addClass("gv-wait"):$containers.removeClass("gv-wait")},remove_tooltips:function(e){c(e||".gv-add-field").is(":ui-tooltip")&&c(".gv-add-field").gvTooltip("destroy").off("click")},init_tooltips:function(e){0!==c(e||".gv-add-field","#post").not(":ui-tooltip").length&&c(e||".gv-add-field","#post").gvTooltip({show:150,hide:200,content:function(){var e=c(this).attr("data-context"),t=c(this).attr("data-formid")||c("#gravityview_form_id").val(),i=c("#gravityview_directory_template").val();switch(c(this).attr("data-objecttype")){case"search":case"field":return c("#"+e+"-available-fields-"+(t||i)).html();case"widget":return c("#directory-available-widgets").html()}},close:function(){c(this).attr("data-tooltip",null)},open:function(e,t){c(this).attr("data-tooltip","active").attr("data-tooltip-id",c(this).attr("aria-describedby"));let i=c("input[type=search]",t.tooltip);i.length||(i=c(t.tooltip).find(".close").first());var a="list",t=(c(t).find(".gv-items-picker-container[data-layout]").length?a=c(t).find(".gv-items-picker-container[data-layout]").attr("data-layout"):(t=c.cookie("gv-items-picker-layout"),g.getCookieVal(t)&&(a=t)),g.setTooltipLayout(a),i[0].focus({preventScroll:!0}),i[0].getBoundingClientRect());(t.y<0||t.y>document.body.getBoundingClientRect().height)&&window.scrollTo({left:window.scrollX,top:window.scrollY+t.y+(t.y<0?-60:60),behavior:"smooth"})},disabled:!0,position:{my:"center bottom",at:"center top-12"},tooltipClass:"gravityview-item-picker-tooltip top"}).attr("title",function(){return c(this).attr("title")||c(this).data("title")||""}).on("mouseout focusout",e=>e.stopImmediatePropagation()).on("click",function(e,t){c(this).attr("title",""),c(this).data("before",null),t?.before&&c(this).data("before",t.before),e.preventDefault(),c(this).gvTooltip("open")})},setupFieldFilters:function(e){function o(e){return"string"!=typeof e?"":e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}var n=c(this).val().trim(),t=c(this).parents(".ui-tooltip-content"),i=t.find(".gv-no-results");"keydown"===e.type?c(this).attr("data-has-search",0<n.length?n.length:null):(t.find(".gv-fields").show().filter(function(){var e=o(n),t=c(this).find(".gv-field-label").attr("data-original-title")||"",i=c(this).attr("data-fieldid")||"",a=c(this).attr("data-parent-label")||"",t=""===e||-1!==o(t).indexOf(e),i=""===e||-1!==o(i).indexOf(e),a=""===e||a&&-1!==o(a).indexOf(e);return!(t||i||a)}).hide(),t.find(".gv-fields:visible").length?i.hide():i.show())},refreshGFtooltips:function(){c(".gf_tooltip").gvTooltip({show:500,hide:1e3,content:function(){return c(this).prop("title")}})},getConfiguredFields:function(){var e=g._getTemplateSection(),t={directory:"#directory-active-fields",single:"#single-active-fields"},t=t.hasOwnProperty(e)?t[e]:"#directory-active-fields, #single-active-fields, #edit-active-fields";return c(t).find(".gv-fields")},getAvailableFields:function(o,n){return new Promise((t,e)=>{var i=g,a=(i.toggleDropMessage(),i.getConfiguredFields().remove(),{action:"gv_available_fields",nonce:gvGlobals.nonce});a.form_preset_ids=void 0!==o&&"preset"===o?[n]:[i.gvSelectForm.val()],c("#directory-available-fields-"+a.form_preset_ids[0]).length||c.post(ajaxurl,a,function(e){e.success||e.data||t(),c.each(e.data,function(e,t){c("#"+e+"-fields").append(t)}),t()})})},startAddField:function(e){c(this).has(".field-id-all-fields").length?g.addAllFields(c(this)):g.addField(c(this),e)},addAllFields:function(e){let t=e.siblings(".gv-fields").filter(function(){var e=c(this).data("fieldid");return+e===parseInt(e,10)});!async function(){for(let e=0;e<t.length;e++)await(i=>new Promise((e,t)=>{c(document.body).one("gravityview/field-added",function(){e()}),c(i).trigger("click")}))(t[e]);c("a.gv-add-field[data-tooltip='active']").gvTooltip("close")}()},addField:function(e,t){t.preventDefault();var t=e.closest(".ui-tooltip").attr("id"),t=c('.gv-add-field[data-tooltip-id="'+t+'"]'),i=t.data("before");g.placeField(e,t,i,!!i),g.toggleAllowedOnceField(e)},placeField:function(t,i,a,o=!1){let r=g,l=t.clone().hide();var e={action:"gv_field_options",template:i.attr("data-templateid")??i.parents(".gv-section").find(".view-template-select select").val()??c("#gravityview_directory_template").val(),area:i.attr("data-areaid"),context:i.attr("data-context"),field_id:l.attr("data-fieldid"),field_label:l.find(".gv-field-label").attr("data-original-title"),field_type:i.attr("data-objecttype"),input_type:l.attr("data-inputtype"),form_id:parseInt(t.attr("data-formid"),10)||r.currentFormId,nonce:gvGlobals.nonce};c.ajax({type:"POST",url:ajaxurl,data:e,async:!0,beforeSend:function(){r.disable_publish()},complete:function(){r.enable_publish()}}).done(function(n){var e=/[^\[]+\[[^\]]+\]\[([^\]]+)\].*/i;if(0<t.find("input.field-key").length){l.find(".gv-dialog, .gv-dialog-options").remove();let a=t.find("input.field-key").attr("name").replace(e,"$1"),o=n.match(e,"$1")[1]??null;n=c(n),t.find(".gv-dialog-options :input").each(function(e,t){var i;c(t).attr("name")&&(1===(i=n.find('[name="'+c(t).attr("name").replaceAll(""+a,""+o)+'"]')).length?i.val(c(t).val()):2===i.length&&c(t).is(":checked")&&i.prop("checked",!0))})}l.append(n),c(".ui-tabs-panel").each(function(){r.init_droppables(this)}),0<c(".gv-dialog-options",l).length&&c(".gv-field-settings",l).removeClass("hide-if-js"),a?(e=o?"insertBefore":"insertAfter",l[e](a)):i.closest(".gv-droppable-area").find(".active-drop").first().append(l),c(document.body).trigger("gravityview/field-added",l),l.fadeIn(100),r.refreshGFtooltips()}).fail(function(e){r.enable_publish(),alert(gvGlobals.field_loaderror),console.log(e)}).always(function(){r.toggleDropMessage(),r.setUnsavedChanges(!0)})},duplicateField:function(e){e.preventDefault();e=c(this).closest(".gv-fields");g.placeField(e,c(this).closest(".active-drop-container").find("a.gv-add-field"),e)},onTooltipOpen:function(e,t){g.filterFields(e.target,t.tooltip[0])},toggleAllowedOnceField:function(e,t=!0){c(e).is('[data-allowed-once="true"]')||(e=c(e).closest('[data-allowed-once="true"]')),c(e).toggleClass("gv-field--is-added",t)},filterFields:function(e,t){let a=c(e).closest(".gv-section").find("[data-fieldid]").map((e,t)=>c(t).data("fieldid")).toArray();var i,e=c(t).html();e&&((i=c("<div>").html(e)).find('[data-allowed-once="true"]').each((e,t)=>{var i=-1<a.indexOf(c(t).data("fieldid"));g.toggleAllowedOnceField(t,i)}),e=i.html(),c(t).html(e))},refresh_merge_tags:function(e,t){let i=e?c(".gv-merge-tag-support,.merge-tag-support",e):c(".gv-merge-tag-support:visible");i.removeClass("gv-merge-tag-support mt-initialized").addClass("merge-tag-support"),window.gform?.instances?.mergeTags?(c(".all-merge-tags",e).remove(),document.dispatchEvent(new Event("DOMContentLoaded")),setTimeout(function(){i.removeClass("merge-tag-support").addClass("gv-merge-tag-support"),t&&t()},300)):"undefined"!=typeof form&&c(document.body).not(".gv-form-changed")&&0<=i.length&&(window.gfMergeTags&&(c(".all-merge-tags:visible").remove(),gfMergeTags.hasOwnProperty("destroy")?i.each(function(){new gfMergeTagsObj(form,c(this))}):window.gfMergeTags=new gfMergeTagsObj(form)),i.removeClass("merge-tag-support").addClass("gv-merge-tag-support"),t)&&t()},enable_publish:function(){c(document).trigger("autosave-enable-buttons.edit-post"),c("#publishing-action").find("#publish").prop("disabled",null).removeClass("button-primary-disabled")},disable_publish:function(){c(document).trigger("autosave-disable-buttons.edit-post"),c("#publishing-action").find("#publish").prop("disabled","disabled").addClass("button-primary-disabled")},init_droppables:function(e){var o;c(e).find(".active-drop-field").sortable("instance")||(o=g,c(e).find(".active-drop-widget").sortable({placeholder:"fields-placeholder",items:"> .gv-fields",distance:2,revert:75,connectWith:".active-drop-widget",start:function(e,t){c("#directory-fields, #single-fields").find(".active-drop-container-widget").addClass("is-receivable")},stop:function(e,t){c("#directory-fields, #single-fields").find(".active-drop-container-widget").removeClass("is-receivable")},change:function(e,t){o.setUnsavedChanges(!0)},receive:function(e,t){var i=t.sender.attr("data-areaid"),a=c(this).attr("data-areaid");t.item.find('[name^="widgets['+i+']"]').each(function(){var e=c(this).attr("name");c(this).attr("name",e.replace(i,a))}),o.toggleDropMessage()}}),c(e).find(".active-drop-field").sortable({placeholder:"fields-placeholder",items:"> .gv-fields",distance:2,revert:75,connectWith:".active-drop-field",start:function(e,t){c(document.body).find(".active-drop-container-field").addClass("is-receivable")},stop:function(e,t){c(document.body).find(".active-drop-container-field").removeClass("is-receivable")},change:function(e,t){o.setUnsavedChanges(!0)},receive:function(e,t){var i,a;0<t.item.find(".gv-dialog-options").length&&(i=t.sender.attr("data-areaid"),a=c(this).attr("data-areaid"),t.item.find('[name^="fields['+i+']"]').each(function(){var e=c(this).attr("name");c(this).attr("name",e.replace(i,a))})),o.toggleDropMessage()}}),c(e).find(".active-drop-search").sortable({placeholder:"fields-placeholder",items:"> .gv-fields",distance:2,revert:75,connectWith:".active-drop-search",start:function(e,t){t=t.item.data("allowed-sections");let i=c(document.body).find(".active-drop-container-search");if(t){let e=t.split(",");i=i.filter(function(){return-1<e.indexOf(c(this).closest("[data-grid-context]").data("grid-context"))})}i.addClass("is-receivable")},stop:function(e,t){c(document.body).find(".active-drop-container-search").removeClass("is-receivable")},change:function(){o.setUnsavedChanges(!0)},receive:function(e,a){if(0<a.item.find(".gv-dialog-options").length){let t=a.sender.attr("data-areaid"),i=c(this).attr("data-areaid");a.item.find('[name*="['+t+']"]').each(function(){var e=c(this).attr("name");c(this).attr("name",e.replace(t,i))})}var t,i=a.item.data("allowed-sections");i&&(t=c(this).closest("[data-grid-context]").data("grid-context"),i.split(",").includes(t)||c(a.sender).sortable("cancel")),o.toggleDropMessage()},over:function(e,t){var i=c(this).closest("[data-grid-context]").data("grid-context"),a=t.item.data("allowed-sections");a&&!a.split(",").includes(i)&&t.item.addClass("gv-field--not-allowed")},out:function(e,t){t.item.removeClass("gv-field--not-allowed")}}))},toggleDropMessage:function(){c(".active-drop").each(function(){0<c(this).find(".gv-fields").length?c(this).find(".drop-message").hide():c(this).find(".drop-message").fadeIn(100)})},removeField:function(e){e.preventDefault();var t=g,i=c(e.currentTarget).parentsUntil(".active-drop").parent();t.setUnsavedChanges(!0),e.altKey&&1<c(i).find(".gv-fields").length?t.removeAllFields(e,i):c(e.currentTarget).parentsUntil(".gv-fields").parent().fadeOut("fast",function(){c(this).remove(),c(document.body).trigger("gravityview/field-removed",c(this)),t.toggleDropMessage()})},removeAllFields:function(e,t){e.preventDefault(),window.confirm(gvGlobals.remove_all_fields)&&((t=t||null)||(area_id=c(e.originalEvent.target).data("areaid"),t=c(e.originalEvent.target).parents('div[data-areaid="'+area_id+'"]')[0]),c(t).find(".gv-fields").remove(),c(document.body).trigger("gravityview/all-fields-removed"),g.toggleDropMessage())},toggleRemoveAllFields:function(){let i;c(".active-drop:visible").each(function(e,t){i=1<c(this).find(".gv-fields").length,c(".clear-all-fields",c(t).parents(".gv-droppable-area")).toggleClass("gv-hide",!i)})},openFieldSettings:function(e){e.preventDefault();var t,i=c(e.target).closest('[data-fieldid="search_bar"]');i.length&&c(e.target).closest(i.find(".gv-dialog-options")).length||(t=g,i=c(e.currentTarget).is(".gv-fields")?c(e.currentTarget):c(e.currentTarget).parents(".gv-fields"),c(".gv-field-settings",i).first().addClass("active"),t.updateVisibilitySettings(e,!0),c(document.body).on("change",".gv-fields input[type=checkbox]",t.updateVisibilitySettings),e=[{text:gvGlobals.label_close,class:"button button-link",click:function(){c(this).dialog("close")}}],(i=i.find(".gv-dialog-options").first()).find(":input").one("change",function(){t.setUnsavedChanges(!0)}),t.showDialog(i,e))},updateVisibilitySettings:function(e,t){var i=g,e=(t=t||!1,c(e.currentTarget).is(".gv-fields")?c(e.currentTarget):c(e.currentTarget).parents(".gv-fields"));c(".gv-setting-list",e).trigger("change"),c("input[type=checkbox]",e).attr("disabled",null),t||i.setUnsavedChanges(!0)},toggleVisibility:function(e,t,i,a){e=e.is(":checked");(a?!e:e)?t.parents(".gv-setting-container").fadeIn(0):t.parents(".gv-setting-container").fadeOut(0)},processFormSubmit:function(e){var t=g,i=t._getTemplateId();return!!t.validateSettingFields(e)&&(t.startFreshStatus?(t.createPresetForm(e,i),!1):(!t.startFreshStatus||""===i)&&(t.setUnsavedChanges(!1),t.serializeForm(e)))},setUnsavedChanges(e){g.hasUnsavedChanges=e},serializeForm:function(e){var t,i,a=c("#post");return!!a.data("gv-valid")||(e.stopImmediatePropagation(),a.data("gv-valid",!1),a.data("gv-serialized")?t=a.data("gv-serialized"):(t=(i=a.find("[name^=fields]").filter(":input")).serialize(),i.prop("disabled",!0),a.data("gv-serialized",t)),a.find("[name=gv_fields]").filter(":input").prop("disabled",!0),a.append(c("<input/>",{name:"gv_fields",value:t,type:"hidden"})),setTimeout(function(){a.data("gv-valid",!0),"click"===e.type?c(e.target).trigger("click"):a.trigger("submit")},101),!1)},validateSettingFields:function(e){var t=o.metaboxObj,i=t.find("[name^=template_settings].gv-error").filter(function(){return"none"!==c(this).closest("tr.alternate").css("display")});if(!i.length)return!0;e.stopImmediatePropagation(),e.preventDefault();e=i.first().closest("div[role=tabpanel]").prop("id");return t.find(".ui-tab[aria-controls="+e+"] a.nav-tab").trigger("click"),window.scrollTo({top:t.offset().top,behavior:"smooth"}),!1},createPresetForm:function(t,e){var i=g,a=c(t.target),e=(t.stopPropagation(),{action:"gv_set_preset_form",template_id:e,nonce:gvGlobals.nonce});return c.ajax({type:"POST",url:ajaxurl,data:e,async:!1,success:function(e){"false"!==e&&"0"!==e?(i.startFreshStatus=!1,i.gvSelectForm.find("option:selected").removeAttr("selected").end().append(e),"click"===t.type?a.trigger("click"):c("#post").trigger("submit")):a.before('<div id="message" class="error below-h2"><p>'+gvGlobals.label_publisherror+"</p></div>")}}),!1}},o={templateId:null,metaboxObj:null,init:function(){o.metaboxObj=c("#gravityview_settings"),o.initTabs(),c("#gravityview_directory_template").on("change",o.updateSettingsDisplay),c(document.body).on("gravityview/settings/tab/enable",o.enableSettingTab).on("gravityview/settings/tab/disable",o.disableSettingTab)},refresh:function(){o.metaboxObj.trigger("change"),o.metaboxObj.tabs("destroy"),o.initTabs()},updateSettingsDisplay:function(){o.templateId=c(this).val(),c("tr[data-show-if]").each(o.toggleSetting)},toggleSetting:function(){var e=c(this),t=e.attr("data-show-if");t.length<1||!o.templateId||(0<o.templateId.length&&-1<t.indexOf(o.templateId)?e.show():(e.find("select, input").val("").prop("checked",!1),e.hide()))},initTabs:function(){let i="gv-active-setting-tab-"+c("#post_ID").val(),e=c.cookie(i);!1===g.getCookieVal(e)&&(e=0),o.metaboxObj.insertAfter(c("#gravityview_view_config")).tabs({active:e,create:function(e,t){setTimeout(function(){g.setupCodeMirror(t.panel)},50)},activate:function(e,t){c.cookie(i,t.newTab.index(),{path:gvGlobals.admin_cookiepath}),g.setupCodeMirror(t.newPanel),g.zebraStripeSettings()}}).addClass("ui-tabs-vertical ui-helper-clearfix").find("li").removeClass("ui-corner-top")},tabsCreate:function(e,t){var i=c(this).find(".ui-tabs-panel"),a=[];i.each(function(){a.push(c(this).outerHeight(!0))}).css({"min-height":_.max(a)})},enableSettingTab:function(e,t){o.metaboxObj.tabs("enable",c(t).attr("id"))},disableSettingTab:function(e,t){o.metaboxObj.tabs("disable",c(t).attr("id"))}},jQuery(function(i){i("#title-prompt-text").text(gvGlobals.label_viewname),o.init(),g.init(),i(".gv-datepicker").datepicker({dateFormat:"yy-mm-dd",constrainInput:!1});var a="gv-active-tab-"+i("#post_ID").val(),e=i.cookie(a);!1===g.getCookieVal(e)&&(e=0),location.hash&&i(location.hash).length&&(e=i(location.hash).index()-1),i("#gv-view-configuration-tabs").tabs({active:e,hide:!1,show:!1,create:function(e,t){g.init_droppables(t.panel),i(document.body).trigger("gravityview/tab-ready",t.panel).trigger("gravityview/tabs-ready")},activate:function(e,t){i.cookie(a,t.newTab.index(),{path:gvGlobals.cookiepath}),g.init_droppables(t.newPanel),i(document.body).trigger("gravityview/tab-ready",t.newPanel)}});let t=i("#gv-embed-shortcode");i("#gravityview_se_is_secure").on("change",function(){let e=t.val();e&&(e=i(this).is(":checked")?e.replace(/]$/,` secret="${t.data("secret")}"]`):e.replace(/ secret="[^"]+"/,""),t.val(e))}),window.gvAdminActions={initTooltips:g.init_tooltips,removeTooltips:g.remove_tooltips,showDialog:g.showDialog,initDroppables:g.init_droppables,setCustomLabel:g.setCustomLabel,ignoreEscape:g.ignoreEscape},i(document.body).trigger("gravityview/loaded")}),c(function(){let e=c("#gravityview_se_csv_enable");function t(){c('[data-fieldid="export_link"]').toggleClass("csv-disabled",!e.is(":checked")).attr("aria-disabled",e.is(":checked")?"false":"true")}e.on("change",t),t()}),c(function(){let i=c('<svg class="loading" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 12C2 6.47715 6.47715 2 12 2V5C8.13401 5 5 8.13401 5 12H2Z" fill="currentColor"></path></svg>');c(document).on("click",".gk-gravityview-placeholder-actions [data-action]",function(e){var t;e.preventDefault(),g.hasUnsavedChanges&&!window.confirm(gvGlobals.discard_unsaved_changes)||c(this).hasClass("is-idle")||(c(this).addClass("is-idle").html(i),e=c(this).data("action")+"_product",t={text_domain:c(this).data("text-domain"),activate:!0},c.when(g.server_request(e,t)).then(e=>{if(!e.success)throw new Error;document.location=document.location}).fail(()=>c(this).removeClass("is-idle").addClass("is-error").text("Try again")))})})}(jQuery);