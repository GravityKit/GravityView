!function($){"use strict";var self={};self.init=function(){self.maybeDisplayMessages(),1*gvGlobals.add_bulk_action&&self.addBulkAction(),1*gvGlobals.show_column&&(self.addApprovedColumn(),self.setInitialApprovedEntries(),$(".toggleApproved").on("click",self.toggleApproved))},self.maybeDisplayMessages=function(){gvGlobals.bulk_message.length>0&&self.displayMessage(gvGlobals.bulk_message,"updated","#lead_form")},self.setInitialApprovedEntries=function(){$("tr:has(input.entry_approved)").find("a.toggleApproved").addClass("entry_approved").prop("title",gvGlobals.unapprove_title)},self.addBulkAction=function(){if(0!==gvGlobals.bulk_actions.length){var $optgroup,$optgroups=[];$.each(gvGlobals.bulk_actions,function(key){$optgroup=$("<optgroup />",{label:key}),$.each(gvGlobals.bulk_actions[key],function(i){$optgroup.append($("<option />",{value:gvGlobals.bulk_actions[key][i].value}).html(gvGlobals.bulk_actions[key][i].label))}),$optgroups.push($optgroup)}),$("#bulk_action, #bulk_action2, #bulk-action-selector-top, #bulk-action-selector-bottom").append($optgroups)}},self.addApprovedColumn=function(){1===$("tbody tr","#lead_form").length&&1===$("tbody tr td","#lead_form").length||($("thead th.check-column:eq(1), tfoot th.check-column:eq(1), thead .column-is_starred, tfoot .column-is_starred").after('<th scope="col" class="manage-column column-cb gv-approve-column column-is_approved"><a href="'+gvGlobals.column_link+'" title="'+gvGlobals.column_title+'"></a></th>'),$('th.check-column[scope=row]:has(img[src*="star"]),td:has(img[src*="star"]),tbody th.column-is_starred').after('<th scope="row" class="column-is_approved gv-approve-column"><a href="#" class="toggleApproved" title="'+gvGlobals.approve_title+'"></a></th>'))},self.toggleApproved=function(e){e.preventDefault();var entryID=$(this).parent().parent().find('th input[type="checkbox"]').val();return $(this).addClass("loading"),$(this).hasClass("entry_approved")?($(this).prop("title",gvGlobals.approve_title),self.updateApproved(entryID,0,$(this))):($(this).prop("title",gvGlobals.unapprove_title),self.updateApproved(entryID,"Approved",$(this))),!1},self.displayMessage=function(message,messageClass,container){self.hideMessage(container,!0);var messageBox=$('<div class="message '+messageClass+'" style="display:none;"><p>'+message+"</p></div>");$(messageBox).prependTo(container).slideDown(),"updated"===messageClass&&window.setTimeout(function(){self.hideMessage(container,!1)},1e4)},self.hideMessage=function(container,messageQueued){var messageBox=$(container).find(".message");messageQueued?$(messageBox).remove():$(messageBox).slideUp(function(){$(this).remove()})},self.updateApproved=function(entryID,approved,$target){var data={action:"gv_update_approved",entry_id:entryID,form_id:gvGlobals.form_id,approved:approved,nonce:gvGlobals.nonce};return $.post(ajaxurl,data,function(response){response&&($target.removeClass("loading").toggleClass("entry_approved","Approved"===approved),window.UpdateCount("gv_approved_count",0===approved?-1:1),window.UpdateCount("gv_disapproved_count",0===approved?1:-1))}),!0},$(self.init)}(jQuery);