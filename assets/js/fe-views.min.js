jQuery(function($){({init:function(){this.datepicker(),$(".gv-widget-search").each(function(){$(this).attr("data-state",$(this).serialize())}),$(".gv-widget-search").on("keyup, change",this.form_changed),$(".gv-widget-search .gv-search-field-search_all input[type=search]").on("search",function(e){$(e.target).parents("form").trigger("keyup")}),$(".gv-search-clear").on("click",this.clear_search),$("a.gv-sort").on("click",this.multiclick_sort),$(document).on("gform_post_render",this.disable_upload_file_when_limit_reached.bind(this)),$("#search-advanced-toggle").on("click",this.toggle_advanced_search),this.disable_upload_file_when_limit_reached(),this.fix_updating_files_after_edit(),this.number_range(),this.iframe(),this.enable_multi_page_entry_edit()},enable_multi_page_entry_edit:function(){$(document).on("gform_post_render",function(event,formId,currentPage){let $form=$("#gform_"+formId);$form.find('input[type="submit"][name]').each(function(){$(this).on("click",function(){$form.append($("<input>",{type:"hidden",name:this.name,value:this.value}))})})})},fix_updating_files_after_edit:function(){window.gform&&gform.addAction("gform_post_conditional_logic_field_action",(form_id,action,target_id)=>{var existing_files_id;"show"===action&&$(target_id).is(".gfield--type-fileupload")&&(existing_files_id=(action="input_"+target_id.split("_").pop()).replace("input_","#preview_existing_files_"),0!==$(existing_files_id).children().length)&&(existing_files_id=$(target_id).find("input[name="+action+"]")).attr("disabled","file"===existing_files_id[0].type&&"disabled")}),$(document).on("gform_post_render",()=>{$(".ginput_preview_list").each(function(){setTimeout(()=>{if(!(0<$(this).children().length)){var uploader_id=$(this).attr("id").replace("gform_preview_","gform_multifile_upload_"),input_name="input_"+uploader_id.split("_").pop(),uploader=window?.gfMultiFileUploader?.uploaders[uploader_id]||null;if(uploader){var file,uploader_id=$(this).closest("form").find("[name=gform_uploaded_files]"),all_files=JSON.parse(uploader_id.val()||"{}"),input_files=all_files[input_name]||[],uploader_id=(delete all_files[input_name],uploader_id.val(JSON.stringify(all_files)),input_files.map(file=>(file.name=file.uploaded_filename||"unknown",file.id=(file.temp_filename||"").split("_o_").pop().split(".").shift(),file.status=plupload.DONE,file.percent=100,file.gv_is_existing=!0,new plupload.File(file))));for(file of uploader_id)uploader.addFile(file)}else(all_files=$(this).closest(".gfield").find("input[name="+input_name+"]")).attr("disabled","file"===all_files.type?"disabled":"")}},100)})})},disable_upload_file_when_limit_reached:function(){"undefined"!=typeof gfMultiFileUploader&&void 0!==gfMultiFileUploader.uploaders&&$.each(gfMultiFileUploader.uploaders,function(index,uploader){uploader.bind("Init",function(up,params){var fieldId,up=up.settings,max=parseInt(up.gf_vars.max_files,10);0!==max&&(fieldId=up.multipart_params.field_id,fieldId=$("#preview_existing_files_"+fieldId).children().length,gfMultiFileUploader.toggleDisabled(up,max<=fieldId))}),uploader.bind("FilesAdded",function(up,files){var formId,existingFilesCount,fieldId,data=up.settings,max=parseInt(data.gf_vars.max_files,10);if(0!==max)return fieldId=data.multipart_params.field_id,formId=data.multipart_params.form_id,formId=$("#gform_preview_"+formId+"_"+fieldId).children().length,existingFilesCount=$("#preview_existing_files_"+fieldId).children().length,fieldId=max<=existingFilesCount+formId,$.each(files,function(i,file){0<max&&max<=existingFilesCount?(up.removeFile(file),$("#"+file.id).remove()):existingFilesCount++}),gfMultiFileUploader.toggleDisabled(data,fieldId),max<=1||!fieldId||0<$("#"+up.settings.gf_vars.message_id).children().length||($("#"+up.settings.gf_vars.message_id).prepend("<li class='gfield_description gfield_validation_message'>"+$("<div/>").text(gform_gravityforms.strings.max_reached).html()+"</li>"),void setTimeout(function(){wp.a11y.speak($("#"+up.settings.gf_vars.message_id).text())},1e3))})})},form_changed:function(e){e=$(e.target).hasClass("gv-widget-search")?$(e.target):$(e.target).parents("form");e.serialize()===e.attr("data-state")?e.hasClass("gv-is-search")?$(".gv-search-clear",$(this)).text(gvGlobals.clear):$(".gv-search-clear",$(this)).fadeOut(100):$(".gv-search-clear",$(this)).text(gvGlobals.reset).fadeIn(100)},clear_search:function(e){var $form=$(this).parents("form"),changed=$form.attr("data-state")!==$form.serialize();return!(!$form.hasClass("gv-is-search")||changed)||!changed||(e.preventDefault(),$form.trigger("reset"),!1===$form.hasClass("gv-is-search")?$(".gv-search-clear",$form).hide(100):$(".gv-search-clear",$form).text(gvGlobals.clear),!1)},datepicker:function(){jQuery.fn.datepicker&&$(".gv-datepicker").each(function(){var element=jQuery(this),image="",showOn="focus";element.hasClass("datepicker_with_icon")&&(showOn="both",image=jQuery("#gforms_calendar_icon_"+this.id).val()),gvGlobals.datepicker.showOn=showOn,gvGlobals.datepicker.buttonImage=image,gvGlobals.datepicker.buttonImageOnly=!0,gvGlobals.datepicker.dateFormat||(showOn="mm/dd/yy",element.hasClass("mdy")?showOn="mm/dd/yy":element.hasClass("dmy")?showOn="dd/mm/yy":element.hasClass("dmy_dash")?showOn="dd-mm-yy":element.hasClass("dmy_dot")?showOn="dd.mm.yy":element.hasClass("ymd_slash")?showOn="yy/mm/dd":element.hasClass("ymd_dash")?showOn="yy-mm-dd":element.hasClass("ymd_dot")&&(showOn="yy.mm.dd"),gvGlobals.datepicker.dateFormat=showOn),element.datepicker(gvGlobals.datepicker)})},multiclick_sort:function(e){e.shiftKey&&(e.preventDefault(),location.href=$(this).data("multisort-href"))},number_range(){$(".gv-search-number-range").on("change","input",function(){var $name=$(this).attr("name");let current_type=$name.includes("max")?"max":"min",other_type="max"==current_type?"min":"max",$other=$(this).closest(".gv-search-number-range").find('input[name="'+$name.replace(/(min|max)/,other_type)+'"]');setTimeout(function(){var value;$(this).attr(other_type)&&""!==$(this).val()&&(value=parseFloat($(this).val()),"max"==current_type&&value<parseFloat($(this).attr("min"))?$(this).val($(this).attr("min")):"min"==current_type&&value>parseFloat($(this).attr("max"))&&$(this).val($(this).attr("max"))),$other.attr(current_type,$(this).val())}.bind(this),2)}).find("input").trigger("change")},iframe:function(){window.addEventListener("message",function(event){event.data?.removeHash&&history.replaceState(null,null," "),event.data?.closeFancybox&&window.Fancybox&&(history.replaceState(null,null," "),Fancybox.close()),event.data?.reloadPage?location.reload():event.data?.redirectToUrl&&(window.location=event.data.redirectToUrl)})},toggle_advanced_search:function(){$(this).attr("aria-expanded",(i,val)=>"true"===val?"false":"true"),$("#search-advanced").toggleClass("open","true"===$(this).attr("aria-expanded"))}}).init()});