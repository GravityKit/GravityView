jQuery(function($){({init:function(){this.datepicker(),$(".gv-widget-search").each(function(){$(this).attr("data-state",$(this).serialize())}),$(".gv-widget-search").on("keyup, change",this.form_changed),$(".gv-widget-search .gv-search-field-search_all input[type=search]").on("search",function(e){$(e.target).parents("form").trigger("keyup")}),$(".gv-search-clear").on("click",this.clear_search),$("a.gv-sort").on("click",this.multiclick_sort),$(document).on("gform_post_render",this.disable_upload_file_when_limit_reached.bind(this)),this.fix_updating_files_after_edit(),this.number_range(),this.iframe(),this.enable_multi_page_entry_edit()},enable_multi_page_entry_edit:function(){$(document).on("gform_post_render",function(event,formId,currentPage){const $form=$("#gform_"+formId);$form.find('input[type="submit"][name]').each(function(){$(this).on("click",function(){$form.append($("<input>",{type:"hidden",name:this.name,value:this.value}))})})})},fix_updating_files_after_edit:function(){$(document).on("gform_post_render",()=>{$(".ginput_preview_list").each(function(){setTimeout(()=>{if(!(0<$(this).children().length)){const uploader_id=$(this).attr("id").replace("gform_preview_","gform_multifile_upload_");var input_name="input_"+uploader_id.split("_").pop();const uploader=window?.gfMultiFileUploader?.uploaders[uploader_id]||null;if(uploader){const $fields_input=$(this).closest("form").find("[name=gform_uploaded_files]"),all_files=JSON.parse($fields_input.val()||"{}"),input_files=all_files[input_name]||[];delete all_files[input_name],$fields_input.val(JSON.stringify(all_files));for(file of input_files.map(file=>(file.name=file.uploaded_filename||"unknown",file.id=(file.temp_filename||"").split("_o_").pop().split(".").shift(),file.status=plupload.DONE,file.percent=100,file.gv_is_existing=!0,new plupload.File(file))))uploader.addFile(file)}}},100)})})},disable_upload_file_when_limit_reached:function(){"undefined"!=typeof gfMultiFileUploader&&void 0!==gfMultiFileUploader.uploaders&&$.each(gfMultiFileUploader.uploaders,function(index,uploader){uploader.bind("Init",function(existingFilesCount,params){var data=existingFilesCount.settings,max=parseInt(data.gf_vars.max_files,10);0!==max&&(existingFilesCount=data.multipart_params.field_id,existingFilesCount=$("#preview_existing_files_"+existingFilesCount).children().length,gfMultiFileUploader.toggleDisabled(data,max<=existingFilesCount))}),uploader.bind("FilesAdded",function(up,files){var data=up.settings,max=parseInt(data.gf_vars.max_files,10);if(0!==max){var fieldId=data.multipart_params.field_id,limitReached=data.multipart_params.form_id,limitReached=$("#gform_preview_"+limitReached+"_"+fieldId).children().length,existingFilesCount=$("#preview_existing_files_"+fieldId).children().length,limitReached=max<=existingFilesCount+limitReached;return($.each(files,function(i,file){return 0<max&&max<=existingFilesCount?(up.removeFile(file),void $("#"+file.id).remove()):void existingFilesCount++}),gfMultiFileUploader.toggleDisabled(data,limitReached),max<=1||!limitReached)?!0:0<$("#"+up.settings.gf_vars.message_id).children().length||($("#"+up.settings.gf_vars.message_id).prepend("<li class='gfield_description gfield_validation_message'>"+$("<div/>").text(gform_gravityforms.strings.max_reached).html()+"</li>"),void setTimeout(function(){wp.a11y.speak($("#"+up.settings.gf_vars.message_id).text())},1e3))}})})},form_changed:function($form){$form=$($form.target).hasClass("gv-widget-search")?$($form.target):$($form.target).parents("form");$form.serialize()===$form.attr("data-state")?$form.hasClass("gv-is-search")?$(".gv-search-clear",$(this)).text(gvGlobals.clear):$(".gv-search-clear",$(this)).fadeOut(100):$(".gv-search-clear",$(this)).text(gvGlobals.reset).fadeIn(100)},clear_search:function(e){var $form=$(this).parents("form"),changed=$form.attr("data-state")!==$form.serialize();return!(!$form.hasClass("gv-is-search")||changed)||(!changed||(e.preventDefault(),$form.trigger("reset"),!1===$form.hasClass("gv-is-search")?$(".gv-search-clear",$form).hide(100):$(".gv-search-clear",$form).text(gvGlobals.clear),!1))},datepicker:function(){jQuery.fn.datepicker&&$(".gv-datepicker").each(function(){var element=jQuery(this),format="",showOn="focus";element.hasClass("datepicker_with_icon")&&(showOn="both",format=jQuery("#gforms_calendar_icon_"+this.id).val()),gvGlobals.datepicker.showOn=showOn,gvGlobals.datepicker.buttonImage=format,gvGlobals.datepicker.buttonImageOnly=!0,gvGlobals.datepicker.dateFormat||(format="mm/dd/yy",element.hasClass("mdy")?format="mm/dd/yy":element.hasClass("dmy")?format="dd/mm/yy":element.hasClass("dmy_dash")?format="dd-mm-yy":element.hasClass("dmy_dot")?format="dd.mm.yy":element.hasClass("ymd_slash")?format="yy/mm/dd":element.hasClass("ymd_dash")?format="yy-mm-dd":element.hasClass("ymd_dot")&&(format="yy.mm.dd"),gvGlobals.datepicker.dateFormat=format),element.datepicker(gvGlobals.datepicker)})},multiclick_sort:function(e){e.shiftKey&&(e.preventDefault(),location.href=$(this).data("multisort-href"))},number_range(){$(".gv-search-number-range").on("change","input",function(){const $name=$(this).attr("name"),current_type=$name.includes("max")?"max":"min",other_type="max"==current_type?"min":"max",$other=$(this).closest(".gv-search-number-range").find('input[name="'+$name.replace(/(min|max)/,other_type)+'"]');setTimeout(function(){var value;$(this).attr(other_type)&&""!==$(this).val()&&(value=parseFloat($(this).val()),"max"==current_type&&value<parseFloat($(this).attr("min"))?$(this).val($(this).attr("min")):"min"==current_type&&value>parseFloat($(this).attr("max"))&&$(this).val($(this).attr("max"))),$other.attr(current_type,$(this).val())}.bind(this),2)}).find("input").trigger("change")},iframe:function(){window.addEventListener("message",function(event){event.data?.removeHash&&history.replaceState(null,null," "),event.data?.closeFancybox&&window.Fancybox&&(history.replaceState(null,null," "),Fancybox.close()),event.data?.reloadPage?location.reload():event.data?.redirectToUrl&&(window.location=event.data.redirectToUrl)})}}).init()});