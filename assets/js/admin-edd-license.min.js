!function($){"use strict";var GV_EDD={message:"",license_field:$("#license_key"),activate_button:$("[data-edd_action=activate_license]"),deactivate_button:$("[data-edd_action=deactivate_license]"),check_button:$("[data-edd_action=check_license]"),admin_notices:$("#message.notice.updated"),init:function(){GV_EDD.message_fadeout(),GV_EDD.add_status_container(),$(".gv-version-info").appendTo(".gform-settings-header_buttons"),$("#gform-settings-save").addClass("button").removeClass("gfbutton"),$(document).on("keyup gv-init",GV_EDD.license_field,GV_EDD.key_change).on("click",".gv-edd-action",GV_EDD.clicked).on("gv-edd-failed gv-edd-invalid",GV_EDD.failed).on("gv-edd-valid",GV_EDD.valid).on("gv-edd-deactivated",GV_EDD.deactivated).on("gv-edd-inactive gv-edd-other",GV_EDD.other).on("click","a[rel*=external]",GV_EDD.open_external_links).on("change","#gform-settings",GV_EDD.toggle_checkboxes).trigger("gv-init")},message_fadeout:function(){setTimeout(function(){$("#gform_tab_group #message").toggle("scale")},2e3)},add_status_container:function(){$(GVGlobals.license_box).insertBefore(GV_EDD.license_field)},key_change:function(e){var license_key=$("#license_key").val(),showbuttons=!1,hidebuttons=!1;if(license_key.length>0)switch($("#license_key_status").val()){case"valid":hidebuttons=$("[data-edd_action=activate_license]"),showbuttons=$("[data-edd_action=deactivate_license],[data-edd_action=check_license]");break;default:case"deactivated":case"site_inactive":hidebuttons=$("[data-edd_action=deactivate_license]"),showbuttons=$("[data-edd_action=activate_license],[data-edd_action=check_license]")}else 0===license_key.length&&(hidebuttons=$("[data-edd_action*=_license]"));var speed="ready"===e.type?0:"fast";hidebuttons&&hidebuttons.filter(":visible").fadeOut(speed),showbuttons&&showbuttons.filter(":hidden").removeClass("hide").hide().fadeIn(speed)},update_status:function(selector,message){""!==message&&$(selector).replaceWith(message).fadeIn()},set_pending_message:function(message){$(".gv-license-details").attr("aria-busy","true").find("ul").animate({opacity:.5},1e3),$("#gv-edd-status").attr("aria-busy","true").removeClass("hide").removeClass("success").removeClass("warning").removeClass("error").addClass("pending").addClass("info").html($("#gv-edd-status").html().replace(/(<strong>)(.*?)(<\/strong)>/,"$1"+message))},clicked:function(e){e.preventDefault();var $that=$(this),theData={license:$("#license_key").val(),edd_action:$that.attr("data-edd_action"),field_id:$that.attr("id")};$that.not(GV_EDD.check_button).addClass("button-disabled"),$("#gform-settings,#gform-settings .button").css("cursor","wait"),GV_EDD.set_pending_message($that.attr("data-pending_text")),GV_EDD.post_data(theData)},open_external_links:function(){return window.open(this.href),!1},parse_response_json:function(string){var response_object;try{response_object=JSON.parse(string)}catch(exception){var second_try=string.replace(/((.|\n)+?){"/gm,'{"');try{response_object=JSON.parse(second_try)}catch(e){console.log("*** \n*** \n*** Error-causing response:\n***\n***\n",string);response_object={message:'<div id="gv-edd-status" aria-live="polite" class="gv-edd-message inline error"><p>'+"JSON failed: another plugin caused a conflict with completing this request. Check your browser's Javascript console to view the invalid content."+"</p></div>"}}}return response_object},post_data:function(theData){$.post(ajaxurl,{action:"gravityview_license",data:theData},function(response){var response_object=GV_EDD.parse_response_json(response);GV_EDD.message=response_object.message,"check_license"!==theData.edd_action&&($("#license_key_status").val(response_object.license),$("#license_key_response").val(JSON.stringify(response_object)),$(document).trigger("gv-edd-"+response_object.license,response_object)),GV_EDD.update_status("#gv-edd-status",response_object.message),GV_EDD.update_status(".gv-license-details",response_object.details),$("#gform-settings").css("cursor","default").find(".button").css("cursor","pointer")})},valid:function(e){GV_EDD.activate_button.fadeOut("medium",function(){GV_EDD.activate_button.removeClass("button-disabled"),GV_EDD.deactivate_button.fadeIn().css("display","inline-block"),GV_EDD.admin_notices.fadeOut(function(){$(this).remove()})}),GV_EDD.get_prefers_reduced_motion?$(".gv-license-warning").hide():$(".gv-license-warning").slideUp("fast")},failed:function(e){GV_EDD.deactivate_button.removeClass("button-disabled"),GV_EDD.activate_button.removeClass("button-disabled"),$(".gv-license-warning").slideDown("fast")},deactivated:function(e){GV_EDD.deactivate_button.css("min-width",function(){return $(this).width()}).fadeOut("medium",function(){GV_EDD.deactivate_button.removeClass("button-disabled"),GV_EDD.activate_button.fadeIn(function(){$(this).css("display","inline-block")})}),GV_EDD.get_prefers_reduced_motion?$(".gv-license-warning").show():$(".gv-license-warning").slideDown("fast")},other:function(e){GV_EDD.deactivate_button.fadeOut("medium",function(){GV_EDD.activate_button.removeClass("button-disabled").fadeIn().css("display","inline-block")})},get_prefers_reduced_motion:function(){return!!window.hasOwnProperty("matchMedia")&&!window.matchMedia("(prefers-reduced-motion: no-preference)").matches},toggle_checkboxes:function(e){GV_EDD.toggle_required(e.currentTarget,"requires",!1),GV_EDD.toggle_required(e.currentTarget,"requires-not",!0)},toggle_required:function(currentTarget,data_attr,reverse_logic){var $parent=$(currentTarget);$parent.find("[data-"+data_attr+"]").each(function(){var requires=$(this).data(data_attr),requires_array=requires.split("="),requires_name=requires_array[0],requires_value=requires_array[1],$input=$parent.find(':input[name$="'+requires_name+'"]').not("[type=hidden]");$input.is(":checkbox")?reverse_logic?$(this).parents(".gform-settings-field").toggle($input.not(":checked")):$(this).parents(".gform-settings-field").toggle($input.is(":checked")):void 0!==requires_value&&(reverse_logic?$(this).parents(".gform-settings-field").toggle($input.val()!==requires_value):$(this).parents(".gform-settings-field").toggle($input.val()===requires_value))})}};GV_EDD.init()}(jQuery);